<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=no">
  <title></title>
</head>
<link rel="stylesheet" href="http://m.zhonglingxiao.dev.mararun.com/assets/css/login/login.css">
<script src="./bscroll.min.js"></script>
<script>
var dots = '';
  function Slider(options) {
    this.options = {
      wrap: options.wrap,
      inner: options.inner,
      dots: options.dots,
      speed: options.speed,
      auto: options.auto
    }

    this.$slider = document.querySelector(options.wrap);
    this.$content = document.querySelector(options.inner);
    this.$dots = document.querySelector(options.dots);

    this.resize();

    this.runScroll();

    this.autoScroll();
  }

  Slider.prototype = {
    init: function(isResize) {

      var sliderWidth = window.getComputedStyle(this.$slider).width;
      sliderWidth = parseInt(sliderWidth);

      var sliderItems = this.$content.children;

      var sliderLength = this.pages = sliderItems.length;

      //默认不进行循环展示,有个问题 如果不循环page从0开始反之从1开始
      if (!isResize) {
        // sliderLength += 2;
      }

      var contentWidth = sliderLength * sliderWidth;

      this.$content.style.width = contentWidth + 'px';

      for (var i = 0; i < this.pages; i++) {
        sliderItems[i].style.width = sliderWidth + 'px';
      }

      !isResize ? this.createDots() : null;
    },
    createDots: function() {
      for (var i = 0; i < this.pages; i++) {
        if (i === 0) {
          dots = '<span class="on"></span>';
        } else {
          dots += '<span></span>'
        }
      }
      this.$dots.innerHTML = dots;
    },
    resize: function() {
      var that = this;

      window.addEventListener('resize', function() {
        that.init(true);
      })
    },
    runScroll: function() {
      var that = this;

      this.init(false);

      this.slider = new BScroll(this.$slider, {
        scrollX: true,
        scrollY: false,
        momentum: false,
        snap: true,
        snapLoop: false,
        snapSpeed: this.options.speed
      });

      this.slider.on('scrollEnd', function() {
        that.currentPage = that.slider.getCurrentPage().pageX;

        for(var i = 0; i < that.$dots.children.length; i++) {
          that.$dots.children[i].className = '';
          if (i === (that.currentPage - 1)) {
            that.$dots.children[i].className = 'on';
          }
        }
      });
    },
    autoScroll: function() {
      if (!this.options.auto) {
        return
      }
      var that = this;
      console.log(that.slider)
      var page = that.slider.getCurrentPage().pageX;

      setInterval(function(){
        that.slider.next()
      }, this.options.auto)
    }
  }

</script>
<style>
  html,body{
    width: 100%;
    height: 100%;
  }
.slider {
  position: relative;
  overflow: hidden;
  margin: 0 auto;
  width: 100%;
  max-width: 750px;
}

.slider .slider-content {
  overflow: hidden;
  min-height: 1px;
}

.slider .slider-content .slider-item {
  float: left;
}


.wrap{
  overflow: hidden;
  position: relative;

}
.scroller-content{
  z-index:10;
  background:white;
  position:relative;
}

</style>
<body>
  <div class="slider">
    <div class="slider-content">
      <div class="slider-item">
        <div class="wrap">
          <div class="scroller-content">
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
          </div>
        </div>
      </div>
      <div class="slider-item">
        <div class="wrap">
          <div class="scroller-content">
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
          </div>
      </div>
      </div>
      <div class="slider-item">
        <div class="wrap">
          <div class="scroller-content">
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
            <p>12313</p>
          </div>
      </div>
      </div>
   </div>
   <div class="dots"></div>
</div>

</body>
<script>
//动态计算屏幕高度
document.querySelectorAll('.wrap').forEach((v)=>{
  v.style.height = document.body.clientHeight+ 'px'
  new BScroll(v,{
  });
})

  new Slider({
    wrap: '.slider',
    inner: '.slider-content',
    dots: '.dots',
    speed: 400,
  });

  </script>
  </html>
